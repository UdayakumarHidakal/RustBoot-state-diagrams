<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1041px" preserveAspectRatio="none" style="width:1688px;height:1041px;background:#FFFFFF;" version="1.1" viewBox="0 0 1688 1041" width="1688px" zoomAndPan="magnify"><defs/><g><rect height="26.2969" id="_title" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="125" x="780.25" y="15"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="115" x="785.25" y="32.9951">rustBoot Flow</text><rect fill="#DDDDDD" height="97.4844" id="_legend" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1.0;" width="182" x="1485.5" y="55.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1491.5" y="76.292"> </text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="1495.5" y="76.292">Value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1540.5" y="76.292"> </text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1544.5" y="76.292"> </text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="54" x="1548.5" y="76.292">States</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1602.5" y="76.292"> </text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1495.5" y="92.5889">0xFF</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="1548.5" y="92.5889">New State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1495.5" y="108.8857">0x70</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1548.5" y="108.8857">Updating State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1495.5" y="125.1826">0x10</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1548.5" y="125.1826">Testing State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1495.5" y="141.4795">0x00</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="1548.5" y="141.4795">Success State</text><line style="stroke:#000000;stroke-width:1.0;" x1="1491.5" x2="1661.5" y1="63.2969" y2="63.2969"/><line style="stroke:#000000;stroke-width:1.0;" x1="1491.5" x2="1661.5" y1="79.5938" y2="79.5938"/><line style="stroke:#000000;stroke-width:1.0;" x1="1491.5" x2="1661.5" y1="95.8906" y2="95.8906"/><line style="stroke:#000000;stroke-width:1.0;" x1="1491.5" x2="1661.5" y1="112.1875" y2="112.1875"/><line style="stroke:#000000;stroke-width:1.0;" x1="1491.5" x2="1661.5" y1="128.4844" y2="128.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="1491.5" x2="1661.5" y1="144.7813" y2="144.7813"/><line style="stroke:#000000;stroke-width:1.0;" x1="1491.5" x2="1491.5" y1="63.2969" y2="144.7813"/><line style="stroke:#000000;stroke-width:1.0;" x1="1544.5" x2="1544.5" y1="63.2969" y2="144.7813"/><line style="stroke:#000000;stroke-width:1.0;" x1="1661.5" x2="1661.5" y1="63.2969" y2="144.7813"/><path d="M552,161.7813 L552,170.3477 L532,174.3477 L552,178.3477 L552,186.9141 A0,0 0 0 0 552,186.9141 L726,186.9141 A0,0 0 0 0 726,186.9141 L726,171.7813 L716,161.7813 L552,161.7813 A0,0 0 0 0 552,161.7813 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M716,161.7813 L716,171.7813 L726,171.7813 L716,161.7813 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="558" y="178.8481">Power ON / Board Reset</text><ellipse cx="522" cy="174.3477" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="470.5" y="206.9141"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="83" x="480.5" y="228.0527">rustBoot Start</text><rect fill="#F1F1F1" height="75.875" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="466.5" y="260.8828"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="91" x="476.5" y="282.0215">Open Partitions</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="476.5" y="295.9902"> </text><ellipse cx="482" cy="305.2891" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="28" x="488.5" y="309.959">Boot</text><ellipse cx="482" cy="319.2578" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="44" x="488.5" y="323.9277">Update</text><polygon fill="#FFA500" points="429.5,356.7578,614.5,356.7578,626.5,388.7695,614.5,420.7813,429.5,420.7813,417.5,388.7695,429.5,356.7578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="429.5" y="366.9683"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="501.5" y="379.7729">Check</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="429.5" y="392.5776"> </text><ellipse cx="435" cy="400.4766" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="440.5" y="405.3823">Boot is in Testing State (0x10)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="429.5" y="418.187"> </text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="386.5" y="386.1753">True</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34" x="626.5" y="386.1753">False</text><rect fill="#F1F1F1" height="103.8125" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="235" x="11" y="430.7813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="211" x="25" y="451.9199">Swapped firmware was not able to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="37" y="465.8887">set the success state (0x00)</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="8" x="21" y="479.8574">  </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="92" x="61" y="493.8262">Trigger Update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="21" y="507.7949"> </text><ellipse cx="26.5" cy="517.0938" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="202" x="33" y="521.7637">set Image state to Updating state</text><rect fill="#DDA0DD" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="202" x="27.5" y="569.5938"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="182" x="37.5" y="590.7324">Roll back to the Boot firmware</text><polygon fill="#FFA500" points="850.5,430.7813,1058.5,430.7813,1070.5,462.793,1058.5,494.8047,850.5,494.8047,838.5,462.793,850.5,430.7813" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="850.5" y="440.9917"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="930.5" y="453.7964">Check</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="8" x="850.5" y="466.6011">  </text><ellipse cx="856" cy="474.5" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="197" x="861.5" y="479.4058">Update is in Updating State (0x70)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="850.5" y="492.2104"> </text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="807.5" y="460.1987">True</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34" x="1070.5" y="460.1987">False</text><rect fill="#F1F1F1" height="103.8125" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="169" x="568.5" y="504.8047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="149" x="578.5" y="525.9434">Jump to rustBoot Update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="105" x="578.5" y="539.9121">Open 3 partitions</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="578.5" y="553.8809"> </text><ellipse cx="584" cy="563.1797" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="28" x="590.5" y="567.8496">Boot</text><ellipse cx="584" cy="577.1484" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="44" x="590.5" y="581.8184">Update</text><ellipse cx="584" cy="591.1172" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="33" x="590.5" y="595.7871">Swap</text><polygon fill="#FFA500" points="558,642.1875,748,642.1875,760,674.1992,748,706.2109,558,706.2109,546,674.1992,558,642.1875" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="558" y="652.3979"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="178" x="566" y="665.2026">Verify Integrty and authenticity</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="160" x="558" y="678.0073">of Image in Update partition</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="28" x="558" y="690.812">       </text><a href="https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg" target="_top" title="verification diagram" xlink:actuate="onRequest" xlink:href="https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg" xlink:show="new" xlink:title="verification diagram" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacing" text-decoration="underline" textLength="57" x="586" y="690.812">Click here</text></a><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="643" y="690.812"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="558" y="703.6167"> </text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="515" y="671.605">True</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34" x="760" y="671.605">False</text><polygon fill="#FFA500" points="429,716.2109,643,716.2109,655,761.0273,643,805.8438,429,805.8438,417,761.0273,429,716.2109" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="429" y="726.4214"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="493" y="739.2261">Prevent rollback</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="513" y="752.0308">Check</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="24" x="429" y="764.8354">      </text><ellipse cx="434.5" cy="772.7344" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="203" x="440" y="777.6401">Update Image Version greater than</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="112" x="433" y="790.4448">Boot Image version</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="429" y="803.2495"> </text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="386" y="758.4331">True</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34" x="655" y="758.4331">False</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="302" x="256" y="815.8438"/><ellipse cx="271.5" cy="832.3125" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="270" x="278" y="836.9824">Swap the Update partition with Boot partition</text><ellipse cx="271.5" cy="846.2813" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="254" x="278" y="850.9512">Set the update image flag to Testing state</text><rect fill="#F1F1F1" height="89.8438" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="277" x="268.5" y="898.5117"/><ellipse cx="284" cy="914.9805" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="180" x="290.5" y="919.6504">Jump to the updated firmware</text><ellipse cx="284" cy="928.9492" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="202" x="290.5" y="933.6191">validate the firmware functionality</text><ellipse cx="284" cy="942.918" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="199" x="290.5" y="947.5879">Update Image state flags erased</text><ellipse cx="284" cy="956.8867" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="245" x="290.5" y="961.5566">set the boot Image flag to success state</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="294.5" y="975.5254">(0x00)</text><ellipse cx="407" cy="1019.3555" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;fill:none;"/><ellipse cx="407" cy="1019.3555" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><rect fill="#FF6347" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="637.5" y="815.8438"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="35" x="647.5" y="836.9824">Panic!</text><rect fill="#FF6347" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="742.5" y="716.2109"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="35" x="752.5" y="737.3496">Panic!</text><polygon fill="#FFA500" points="1167,504.8047,1347,504.8047,1359,543.2188,1347,581.6328,1167,581.6328,1155,543.2188,1167,504.8047" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1167" y="515.0151"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="1235" y="527.8198">Check</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1167" y="540.6245"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="152" x="1171" y="553.4292">* Boot In New State (0xFF)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="176" x="1171" y="566.2339">* Boot In Success State (0x00)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1167" y="579.0386"> </text><polygon fill="#FFA500" points="1011.5,628.6172,1215.5,628.6172,1227.5,660.6289,1215.5,692.6406,1011.5,692.6406,999.5,660.6289,1011.5,628.6172" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1011.5" y="638.8276"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="196" x="1015.5" y="651.6323">Verify Integrity and authenticity of</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="160" x="1015.5" y="664.437">Boot Image in Boot partition</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="28" x="1011.5" y="677.2417">       </text><a href="https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg" target="_top" title="verification diagram" xlink:actuate="onRequest" xlink:href="https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg" xlink:show="new" xlink:title="verification diagram" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacing" text-decoration="underline" textLength="57" x="1039.5" y="677.2417">Click here</text></a><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1096.5" y="677.2417"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1011.5" y="690.0464"> </text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="968.5" y="658.0347">True</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34" x="1227.5" y="658.0347">False</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="178" x="900.5" y="702.6406"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="158" x="910.5" y="723.7793">Jump to the Boot firmware</text><rect fill="#F1F1F1" height="75.875" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="306" x="836.5" y="771.6094"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="938.5" y="792.748">Trigger update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="8" x="846.5" y="806.7168">  </text><ellipse cx="852" cy="816.0156" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="274" x="858.5" y="820.6855">Set the Update Image state to Updating state</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="958.5" y="834.6543">(0x70)</text><path d="M1020.5,882.2148 L1020.5,890.7813 L1000.5,894.7813 L1020.5,898.7813 L1020.5,907.3477 A0,0 0 0 0 1020.5,907.3477 L1119.5,907.3477 A0,0 0 0 0 1119.5,907.3477 L1119.5,892.2148 L1109.5,882.2148 L1020.5,882.2148 A0,0 0 0 0 1020.5,882.2148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1109.5,882.2148 L1109.5,892.2148 L1119.5,892.2148 L1109.5,882.2148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1026.5" y="899.2817">Board Reset</text><ellipse cx="989.5" cy="894.7813" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;fill:none;"/><ellipse cx="989.5" cy="894.7813" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><rect fill="#FF6347" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="1210" y="702.6406"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="35" x="1220" y="723.7793">Panic!</text><polygon fill="#FFA500" points="1424,641.4219,1628,641.4219,1640,673.4336,1628,705.4453,1424,705.4453,1412,673.4336,1424,641.4219" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1424" y="651.6323"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="196" x="1428" y="664.437">Verify Integrity and authenticity of</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="175" x="1428" y="677.2417">Update Image in Boot partition</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="28" x="1424" y="690.0464">       </text><a href="https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg" target="_top" title="verification diagram" xlink:actuate="onRequest" xlink:href="https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg" xlink:show="new" xlink:title="verification diagram" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacing" text-decoration="underline" textLength="57" x="1452" y="690.0464">Click here</text></a><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1509" y="690.0464"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="1424" y="702.8511"> </text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1381" y="670.8394">True</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34" x="1640" y="670.8394">False</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="194" x="1305" y="715.4453"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="174" x="1315" y="736.584">Jump to the Update firmware</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95" x="1331" y="750.5527">in Boot partition</text><ellipse cx="1402" cy="809.3828" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;fill:none;"/><ellipse cx="1402" cy="809.3828" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><rect fill="#FF6347" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="1622.5" y="715.4453"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="35" x="1632.5" y="736.584">Panic!</text><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="522" y1="184.3477" y2="206.9141"/><polygon fill="#181818" points="518,196.9141,522,206.9141,526,196.9141,522,200.9141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="522" y1="240.8828" y2="260.8828"/><polygon fill="#181818" points="518,250.8828,522,260.8828,526,250.8828,522,254.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="534.5938" y2="569.5938"/><polygon fill="#181818" points="124.5,559.5938,128.5,569.5938,132.5,559.5938,128.5,563.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="407" x2="407" y1="863.7813" y2="898.5117"/><polygon fill="#181818" points="403,888.5117,407,898.5117,411,888.5117,407,892.5117" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="407" x2="407" y1="988.3555" y2="1008.3555"/><polygon fill="#181818" points="403,998.3555,407,1008.3555,411,998.3555,407,1002.3555" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="417" x2="407" y1="761.0273" y2="761.0273"/><line style="stroke:#181818;stroke-width:1.0;" x1="407" x2="407" y1="761.0273" y2="815.8438"/><polygon fill="#181818" points="403,805.8438,407,815.8438,411,805.8438,407,809.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="655" x2="665" y1="761.0273" y2="761.0273"/><line style="stroke:#181818;stroke-width:1.0;" x1="665" x2="665" y1="761.0273" y2="815.8438"/><polygon fill="#181818" points="661,805.8438,665,815.8438,669,805.8438,665,809.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="546" x2="536" y1="674.1992" y2="674.1992"/><line style="stroke:#181818;stroke-width:1.0;" x1="536" x2="536" y1="674.1992" y2="716.2109"/><polygon fill="#181818" points="532,706.2109,536,716.2109,540,706.2109,536,710.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="760" x2="770" y1="674.1992" y2="674.1992"/><line style="stroke:#181818;stroke-width:1.0;" x1="770" x2="770" y1="674.1992" y2="716.2109"/><polygon fill="#181818" points="766,706.2109,770,716.2109,774,706.2109,770,710.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="653" x2="653" y1="608.6172" y2="642.1875"/><polygon fill="#181818" points="649,632.1875,653,642.1875,657,632.1875,653,636.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="989.5" x2="989.5" y1="736.6094" y2="771.6094"/><polygon fill="#181818" points="985.5,761.6094,989.5,771.6094,993.5,761.6094,989.5,765.6094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="989.5" x2="989.5" y1="847.4844" y2="883.7813"/><polygon fill="#181818" points="985.5,873.7813,989.5,883.7813,993.5,873.7813,989.5,877.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="999.5" x2="989.5" y1="660.6289" y2="660.6289"/><line style="stroke:#181818;stroke-width:1.0;" x1="989.5" x2="989.5" y1="660.6289" y2="702.6406"/><polygon fill="#181818" points="985.5,692.6406,989.5,702.6406,993.5,692.6406,989.5,696.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1227.5" x2="1237.5" y1="660.6289" y2="660.6289"/><line style="stroke:#181818;stroke-width:1.0;" x1="1237.5" x2="1237.5" y1="660.6289" y2="702.6406"/><polygon fill="#181818" points="1233.5,692.6406,1237.5,702.6406,1241.5,692.6406,1237.5,696.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1402" x2="1402" y1="763.3828" y2="798.3828"/><polygon fill="#181818" points="1398,788.3828,1402,798.3828,1406,788.3828,1402,792.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1412" x2="1402" y1="673.4336" y2="673.4336"/><line style="stroke:#181818;stroke-width:1.0;" x1="1402" x2="1402" y1="673.4336" y2="715.4453"/><polygon fill="#181818" points="1398,705.4453,1402,715.4453,1406,705.4453,1402,709.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1640" x2="1650" y1="673.4336" y2="673.4336"/><line style="stroke:#181818;stroke-width:1.0;" x1="1650" x2="1650" y1="673.4336" y2="715.4453"/><polygon fill="#181818" points="1646,705.4453,1650,715.4453,1654,705.4453,1650,709.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155" x2="1113.5" y1="543.2188" y2="543.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="1113.5" x2="1113.5" y1="543.2188" y2="628.6172"/><polygon fill="#181818" points="1109.5,618.6172,1113.5,628.6172,1117.5,618.6172,1113.5,622.6172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="112" x="1113.5" y="590.4409">* Boot in New state</text><line style="stroke:#181818;stroke-width:1.0;" x1="1359" x2="1526" y1="543.2188" y2="543.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="1526" x2="1526" y1="543.2188" y2="641.4219"/><polygon fill="#181818" points="1522,631.4219,1526,641.4219,1530,631.4219,1526,635.4219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="50" x="1526" y="590.4409">* Boot in</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="80" x="1530" y="603.2456">Success state</text><line style="stroke:#181818;stroke-width:1.0;" x1="838.5" x2="653" y1="462.793" y2="462.793"/><line style="stroke:#181818;stroke-width:1.0;" x1="653" x2="653" y1="462.793" y2="504.8047"/><polygon fill="#181818" points="649,494.8047,653,504.8047,657,494.8047,653,498.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1070.5" x2="1257" y1="462.793" y2="462.793"/><line style="stroke:#181818;stroke-width:1.0;" x1="1257" x2="1257" y1="462.793" y2="504.8047"/><polygon fill="#181818" points="1253,494.8047,1257,504.8047,1261,494.8047,1257,498.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="417.5" x2="128.5" y1="388.7695" y2="388.7695"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="388.7695" y2="430.7813"/><polygon fill="#181818" points="124.5,420.7813,128.5,430.7813,132.5,420.7813,128.5,424.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="626.5" x2="954.5" y1="388.7695" y2="388.7695"/><line style="stroke:#181818;stroke-width:1.0;" x1="954.5" x2="954.5" y1="388.7695" y2="430.7813"/><polygon fill="#181818" points="950.5,420.7813,954.5,430.7813,958.5,420.7813,954.5,424.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="522" y1="336.7578" y2="356.7578"/><polygon fill="#181818" points="518,346.7578,522,356.7578,526,346.7578,522,350.7578" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[b421fc83973bc0ad44af3f1c6fe401ff]
@startuml
title rustBoot Flow

start
note right: Power ON / Board Reset

  :rustBoot Start; 

  :Open Partitions 
  
  * Boot 
  * Update ;

#orange:if (
                  Check 

* Boot is in Testing State (0x10)\n) then (<color:green>**True**)


  : Swapped firmware was not able to 
      set the success state (0x00)
    
            Trigger Update
  
  * set Image state to Updating state;
  #plum:Roll back to the Boot firmware;
  kill
else (<color:red>**False**)
  #orange:if (
                    Check 
  
* Update is in Updating State (0x70)\n) then (<color:green>**True**);
    :Jump to rustBoot Update
    Open 3 partitions
    
    * Boot
    * Update
    * Swap;
    #orange:if (
  Verify Integrty and authenticity \nof Image in Update partition \n       [[https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg{verification diagram} Click here]] \n) then (<color:green>**True**)
    
      #orange:if (\n                Prevent rollback \n                     Check 
      
* Update Image Version greater than \n Boot Image version \n) then (<color:green>**True**)
        :* Swap the Update partition with Boot partition
        * Set the update image flag to Testing state;
        :* Jump to the updated firmware 
        * validate the firmware functionality
        * Update Image state flags erased
        * set the boot Image flag to success state 
            (0x00);
        stop
      else(<color:red>**False**) 
        #tomato:Panic!;
        kill
      endif
    else(<color:red>**False**)
      #tomato:Panic!;
      kill
    endif
  else (<color:red>**False**)
  <style>
diamond  {
  BackgroundColor orange
}
</style>
    switch(\n                 Check\n \n * Boot In New State (0xFF)\n * Boot In Success State (0x00)\n)
    case (* Boot in New state)
      #orange:if (\n Verify Integrity and authenticity of \n Boot Image in Boot partition \n       [[https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg{verification diagram} Click here]] \n) then (<color:green>**True**)
        :Jump to the Boot firmware;
          :                       Trigger update 
          
        * Set the Update Image state to Updating state 
                                    (0x70);
        stop
         note right: Board Reset
        
      else (<color:red>**False**)
        #tomato:Panic!;
        kill
      endif
    case (* Boot in \n Success state)
      #orange:if (\n Verify Integrity and authenticity of \n Update Image in Boot partition \n       [[https://raw.githubusercontent.com/UdayakumarHidakal/RustBoot-state-diagrams/main/verification_diagram.svg{verification diagram} Click here]] \n) then (<color:green>**True**)
        :Jump to the Update firmware 
            in Boot partition;
        stop
      else (<color:red>**False**)
        #tomato:Panic!;
        kill


legend top right
    | **Value** | **States** |
    | 0xFF  | New State |
    | 0x70  | Updating State |
    | 0x10  | Testing State |
    | 0x00  | Success State |
endlegend
@enduml

PlantUML version 1.2022.7beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>