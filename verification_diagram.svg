<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="754px" preserveAspectRatio="none" style="width:560px;height:754px;background:#FFFFFF;" version="1.1" viewBox="0 0 560 754" width="560px" zoomAndPan="magnify"><defs/><g><rect height="26.2969" id="_title" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="276" x="140.5" y="15"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="266" x="145.5" y="32.9951">Verify Integrity and Authenticity</text><path d="M122.5,47.2969 L122.5,72.4297 A0,0 0 0 0 122.5,72.4297 L249.5,72.4297 A0,0 0 0 0 249.5,72.4297 L249.5,65.2969 L269.5,59.8633 L249.5,57.2969 L249.5,57.2969 L239.5,47.2969 L122.5,47.2969 A0,0 0 0 0 122.5,47.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M239.5,47.2969 L239.5,57.2969 L249.5,57.2969 L239.5,47.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="128.5" y="64.3638">Verifing Integrity</text><ellipse cx="279.5" cy="59.8633" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="202" x="178.5" y="92.4297"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="182" x="188.5" y="113.5684">Take the Firmware Image size</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="154" x="202.5" y="146.3984"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="130" x="212.5" y="167.5371">Take the stored Hash</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="98" x="212.5" y="181.5059">from the header</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="203" y="214.3359"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="129" x="213" y="235.4746">Compute Image Hash</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="125" x="213" y="249.4434">using FW image size</text><polygon fill="#FFA500" points="223,282.2734,336,282.2734,348,314.2852,336,346.2969,223,346.2969,211,314.2852,223,282.2734" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="223" y="292.4839"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="109" x="223" y="305.2886">Check Stored Hash</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="247" y="318.0933">is equals to</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="227" y="330.8979">computed Hash</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="223" y="343.7026"> </text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="180" y="311.6909">True</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34" x="348" y="311.6909">False</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="258" x="15.5" y="356.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="238" x="25.5" y="377.4355">Update the hash for the part descriptor</text><rect fill="#DDA0DD" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="242" x="293.5" y="356.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="222" x="303.5" y="377.4355">Return False Image verification failed</text><path d="M98.5,400.2656 L98.5,425.3984 A0,0 0 0 0 98.5,425.3984 L249.5,425.3984 A0,0 0 0 0 249.5,425.3984 L249.5,418.2656 L269.5,412.832 L249.5,410.2656 L249.5,410.2656 L239.5,400.2656 L98.5,400.2656 A0,0 0 0 0 98.5,400.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M239.5,400.2656 L239.5,410.2656 L249.5,410.2656 L239.5,400.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="104.5" y="417.3325">Verifing Authenticity</text><ellipse cx="279.5" cy="412.832" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="202" x="178.5" y="445.3984"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="182" x="188.5" y="466.5371">Take the Firmware Image size</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="181" x="189" y="499.3672"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="157" x="199" y="520.5059">Take the stored Signature</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="98" x="199" y="534.4746">from the header</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="175" x="192" y="567.3047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="155" x="202" y="588.4434">Compute Image signature</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="125" x="202" y="602.4121">using FW image size</text><polygon fill="#FFA500" points="209.5,635.2422,349.5,635.2422,361.5,667.2539,349.5,699.2656,209.5,699.2656,197.5,667.2539,209.5,635.2422" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="209.5" y="645.4526"> </text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="136" x="209.5" y="658.2573">Check Stored Signature</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="241.5" y="671.062">is equals to</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="116" x="213.5" y="683.8667">computed Signature</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="4" x="209.5" y="696.6714"> </text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="166.5" y="664.6597">True</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34" x="361.5" y="664.6597">False</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="258" x="11" y="709.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="238" x="21" y="730.4043">Update the hash for the part descriptor</text><rect fill="#DDA0DD" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="260" x="289" y="709.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="240" x="299" y="730.4043">Return False Image Authentication failed</text><line style="stroke:#181818;stroke-width:1.0;" x1="279.5" x2="279.5" y1="69.8633" y2="92.4297"/><polygon fill="#181818" points="275.5,82.4297,279.5,92.4297,283.5,82.4297,279.5,86.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="279.5" x2="279.5" y1="126.3984" y2="146.3984"/><polygon fill="#181818" points="275.5,136.3984,279.5,146.3984,283.5,136.3984,279.5,140.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="279.5" x2="279.5" y1="194.3359" y2="214.3359"/><polygon fill="#181818" points="275.5,204.3359,279.5,214.3359,283.5,204.3359,279.5,208.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="211" x2="144.5" y1="314.2852" y2="314.2852"/><line style="stroke:#181818;stroke-width:1.0;" x1="144.5" x2="144.5" y1="314.2852" y2="356.2969"/><polygon fill="#181818" points="140.5,346.2969,144.5,356.2969,148.5,346.2969,144.5,350.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="348" x2="414.5" y1="314.2852" y2="314.2852"/><line style="stroke:#181818;stroke-width:1.0;" x1="414.5" x2="414.5" y1="314.2852" y2="356.2969"/><polygon fill="#181818" points="410.5,346.2969,414.5,356.2969,418.5,346.2969,414.5,350.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="279.5" x2="279.5" y1="262.2734" y2="282.2734"/><polygon fill="#181818" points="275.5,272.2734,279.5,282.2734,283.5,272.2734,279.5,276.2734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="279.5" x2="279.5" y1="422.832" y2="445.3984"/><polygon fill="#181818" points="275.5,435.3984,279.5,445.3984,283.5,435.3984,279.5,439.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="279.5" x2="279.5" y1="479.3672" y2="499.3672"/><polygon fill="#181818" points="275.5,489.3672,279.5,499.3672,283.5,489.3672,279.5,493.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="279.5" x2="279.5" y1="547.3047" y2="567.3047"/><polygon fill="#181818" points="275.5,557.3047,279.5,567.3047,283.5,557.3047,279.5,561.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="140" y1="667.2539" y2="667.2539"/><line style="stroke:#181818;stroke-width:1.0;" x1="140" x2="140" y1="667.2539" y2="709.2656"/><polygon fill="#181818" points="136,699.2656,140,709.2656,144,699.2656,140,703.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="361.5" x2="419" y1="667.2539" y2="667.2539"/><line style="stroke:#181818;stroke-width:1.0;" x1="419" x2="419" y1="667.2539" y2="709.2656"/><polygon fill="#181818" points="415,699.2656,419,709.2656,423,699.2656,419,703.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="279.5" x2="279.5" y1="615.2422" y2="635.2422"/><polygon fill="#181818" points="275.5,625.2422,279.5,635.2422,283.5,625.2422,279.5,629.2422" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[585d1cf481805bed7934dd6587746355]
@startuml
title Verify Integrity and Authenticity 

start
note left: Verifing Integrity

:Take the Firmware Image size; 

:Take the stored Hash \nfrom the header;

:Compute Image Hash \nusing FW image size;

#orange:if (\nCheck Stored Hash 
      is equals to
 computed Hash\n) then (<color:Green>**True**)
  :Update the hash for the part descriptor;
  kill
else (<color:Red>**False**)
  #plum:Return False Image verification failed;
endif
kill 

start
note left: Verifing Authenticity

:Take the Firmware Image size; 

:Take the stored Signature \nfrom the header;
:Compute Image signature\nusing FW image size; 

#orange:if (\nCheck Stored Signature 
        is equals to
 computed Signature\n) then (<color:Green>**True**)
  :Update the hash for the part descriptor;
  kill
else (<color:Red>**False**)
  #plum:Return False Image Authentication failed;
endif
kill
@enduml

PlantUML version 1.2022.7beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>